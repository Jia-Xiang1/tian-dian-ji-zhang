<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>甜點記帳 PWA</title>
<link rel="manifest" href="manifest.json">
<style>
body { 
  font-family: Arial; 
  max-width:700px; 
  margin:auto; 
  padding:20px; 
  background:#f2f2f7;
}

h2 { text-align:center; margin-bottom:20px; }

/* 四行輸入區塊 */
.form-card {
  background:#fff;
  border-radius:12px;
  padding:10px 12px;
  margin-bottom:12px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.08), 0 4px 12px rgba(0,0,0,0.06);
  text-align:center;
}

/* 日期 / 份數欄位 */
input[type="date"], input[type="number"], input[type="text"] {
  width:95%;
  max-width:300px;
  padding:6px;
  font-size:1.2em;
  margin-top:6px;
  box-sizing:border-box;
  display:block;
  margin-left:auto;
  margin-right:auto;
}

/* 假選單商品 */
.custom-select {
  position: relative;
  font-size: 1.2em;
  width:95%;
  max-width:300px;
  margin:10px auto 0;
  background: #f2f2f7;
  border-radius: 10px;
  border: 1px solid #d1d1d6;
  cursor: pointer;
  box-sizing: border-box;
}

.custom-select .selected {
  padding: 10px;
  text-align: center;
}

.custom-select .options {
  display: none;
  position: absolute;
  top: 100%;
  left: 0;
  width: 100%;
  background: #fff;
  border-radius: 10px;
  border: 1px solid #d1d1d6;
  max-height: 200px;
  overflow-y: auto;
  z-index: 100;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

.custom-select .option {
  padding: 10px;
  text-align: center;
}

.custom-select .option:hover {
  background: #e5e5ea;
}

/* 新增按鈕 */
#addBtn {
  font-size:1.2em;
  padding:10px;
  width:95%;
  max-width:300px;
  display:block;
  margin:10px auto 0;
  border:none;
  border-radius:12px;
  background:#007aff;
  color:#fff;
}

/* 表格 */
table { 
  width:100%; 
  border-collapse:collapse; 
  margin-top:20px; 
  background:#fff;
  box-shadow:0 1px 3px rgba(0,0,0,0.1);
}

th, td { 
  border:1px solid #ccc; 
  padding:5px; 
  text-align:center; 
}

th { 
  background:#f0f0f0; 
}

/* 今日統計 */
#totals {
  font-size:1.2em;
  padding:10px;
  background:#fff;
  border-radius:12px;
  box-shadow:0 2px 6px rgba(0,0,0,0.1);
  margin-top:15px;
}

/* 後台密碼及設定區 */
#backendWrapper {
  display:none;
  margin-top:15px;
}

/* 後台商品設定 */
#backendWrapper .product-card {
  text-align:center;
  background:#fff;
  padding:8px 10px;
  border-radius:10px;
  margin-bottom:8px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.08);
  display:flex;
  justify-content:center;
  gap:10px;
  flex-wrap:wrap;
}

#backendWrapper input {
  font-size:1em;
  padding:4px;
  width:70px;
  text-align:center;
}
</style>
</head>

<body>
<h2>甜點銷售記帳</h2>

<!-- 日期 -->
<div class="form-card">
  日期<br>
  <input type="date" id="dateInput">
</div>

<!-- 商品 -->
<div class="form-card">
  商品<br>
  <div class="custom-select" id="customProductSelect">
    <div class="selected">雞蛋糕</div>
    <div class="options">
      <div class="option">雞蛋糕</div>
      <div class="option">奶酪杯</div>
      <div class="option">提拉米蘇杯</div>
      <div class="option">雪媚娘</div>
      <div class="option">紅糖糍粑</div>
      <div class="option">奶茶凍</div>
      <div class="option">桂花奶酪</div>
      <div class="option">華夫餅</div>
    </div>
  </div>
</div>

<!-- 份數 -->
<div class="form-card">
  份數<br>
  <input type="number" id="qtyInput" min="1" value="1">
</div>

<!-- 新增按鈕 -->
<div class="form-card">
  <button id="addBtn">新增</button>
</div>

<!-- 表格 -->
<table id="salesTable">
  <thead>
    <tr>
      <th>日期</th>
      <th>商品</th>
      <th>份數</th>
      <th>成本</th>
      <th>售價</th>
      <th>收入</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>

<!-- 今日統計 -->
<div id="totals">
  <strong>今日總成本：</strong><span id="totalCost">0</span> 元<br>
  <strong>今日總收入：</strong><span id="totalRevenue">0</span> 元<br>
  <strong>今日總利潤：</strong><span id="totalProfit">0</span> 元
</div>

<!-- 後台密碼 -->
<div class="form-card">
  <input type="password" id="adminPassword" placeholder="輸入後台密碼">
  <button id="unlockBtn">進入後台</button>
</div>

<!-- 後台設定成本/售價 -->
<div id="backendWrapper">
  <h3 style="text-align:center;">後台設定成本與售價</h3>

  <div class="product-card">
    雞蛋糕 成本 <input type="number" id="cost_雞蛋糕" value="10"> 售價 <input type="number" id="price_雞蛋糕" value="20">
  </div>
  <div class="product-card">
    奶酪杯 成本 <input type="number" id="cost_奶酪杯" value="8"> 售價 <input type="number" id="price_奶酪杯" value="15">
  </div>
  <div class="product-card">
    提拉米蘇杯 成本 <input type="number" id="cost_提拉米蘇杯" value="12"> 售價 <input type="number" id="price_提拉米蘇杯" value="25">
  </div>
  <div class="product-card">
    雪媚娘 成本 <input type="number" id="cost_雪媚娘" value="9"> 售價 <input type="number" id="price_雪媚娘" value="18">
  </div>
  <div class="product-card">
    紅糖糍粑 成本 <input type="number" id="cost_紅糖糍粑" value="7"> 售價 <input type="number" id="price_紅糖糍粑" value="14">
  </div>
  <div class="product-card">
    奶茶凍 成本 <input type="number" id="cost_奶茶凍" value="8"> 售價 <input type="number" id="price_奶茶凍" value="16">
  </div>
  <div class="product-card">
    桂花奶酪 成本 <input type="number" id="cost_桂花奶酪" value="9"> 售價 <input type="number" id="price_桂花奶酪" value="17">
  </div>
  <div class="product-card">
    華夫餅 成本 <input type="number" id="cost_華夫餅" value="10"> 售價 <input type="number" id="price_華夫餅" value="20">
  </div>
</div>

<script>
// 假選單 JS
const select = document.getElementById('customProductSelect');
const selected = select.querySelector('.selected');
const optionsContainer = select.querySelector('.options');
const options = optionsContainer.querySelectorAll('.option');

selected.addEventListener('click', () => {
  optionsContainer.style.display = optionsContainer.style.display === 'block' ? 'none' : 'block';
});

options.forEach(option => {
  option.addEventListener('click', () => {
    selected.textContent = option.textContent;
    optionsContainer.style.display = 'none';
  });
});

document.addEventListener('click', (e) => {
  if (!select.contains(e.target)) {
    optionsContainer.style.display = 'none';
  }
});

// 記帳功能
function updateTotals() {
  const rows = document.querySelectorAll('#salesTable tbody tr');
  let totalCost = 0, totalRevenue = 0;
  const today = document.getElementById('dateInput').value;

  rows.forEach(row => {
    const date = row.cells[0].textContent;
    if(date === today) {
      totalCost += parseFloat(row.cells[3].textContent) * parseInt(row.cells[2].textContent);
      totalRevenue += parseFloat(row.cells[5].textContent);
    }
  });

  document.getElementById('totalCost').textContent = totalCost;
  document.getElementById('totalRevenue').textContent = totalRevenue;
  document.getElementById('totalProfit').textContent = (totalRevenue - totalCost);
}

document.getElementById('addBtn').addEventListener('click', () => {
  const date = document.getElementById('dateInput').value;
  const product = selected.textContent;
  const qty = parseInt(document.getElementById('qtyInput').value);

  if(!date || !product || !qty){
    alert("請填寫完整資訊！");
    return;
  }

  const cost = parseFloat(document.getElementById('cost_' + product).value);
  const price = parseFloat(document.getElementById('price_' + product).value);
  const revenue = price * qty;

  const tbody = document.getElementById('salesTable').querySelector('tbody');
  const row = document.createElement('tr');
  row.innerHTML = `<td>${date}</td><td>${product}</td><td>${qty}</td><td>${cost}</td><td>${price}</td><td>${revenue}</td>`;
  tbody.appendChild(row);

  document.getElementById('qtyInput').value = 1;
  updateTotals();
});

document.getElementById('dateInput').addEventListener('change', updateTotals);

// 後台密碼
const correctPassword = "1234"; 
document.getElementById('unlockBtn').addEventListener('click', () => {
  const pwd = document.getElementById('adminPassword').value;
  if(pwd === correctPassword){
    document.getElementById('backendWrapper').style.display = "block";
    alert("後台已開啟！");
    document.getElementById('adminPassword').value = "";
  } else {
    alert("密碼錯誤！");
  }
});
</script>
</body>
</html>
