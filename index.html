<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>甜點記帳</title>

<style>
body { 
  font-family: Arial; 
  max-width:700px; 
  margin:auto; 
  padding:16px; 
  background:#f2f2f7;
}

table { 
  width:100%; 
  border-collapse:collapse; 
  margin-top:10px; 
}

th, td { 
  border:1px solid #ccc; 
  padding:5px; 
  text-align:center; 
}

th { 
  background:#f0f0f0; 
}

#backend { 
  margin-top:16px; 
  border-top:2px solid #000; 
  padding-top:8px; 
}

/* 卡片式區塊 */
.form-card {
  background:#ffffff;
  border-radius:14px;
  padding:10px 12px 14px;
  margin-bottom:12px;
  box-shadow:
    0 1px 2px rgba(0,0,0,0.08),
    0 4px 12px rgba(0,0,0,0.06);
  font-size:1.4em;
}

/* 日期 / 份數 */
#dateInput, #qtyInput {
  font-size:1.15em;
  padding:4px;
  width:100%;
  box-sizing:border-box;
  text-align:center;
}

/* 假選單（商品） */
.custom-select {
  position: relative;
  font-size: 1.1em;
  width: 100%;
  background: #f2f2f7;
  border-radius: 10px;
  border: 1px solid #d1d1d6;
  cursor: pointer;
  box-sizing: border-box;
}

.custom-select .selected {
  padding: 10px;
  text-align: center;  /* 文字置中 */
}

.custom-select .options {
  display: none;
  position: absolute;
  top: 100%;
  left: 0;
  width: 100%;
  background: #ffffff;
  border-radius: 10px;
  border: 1px solid #d1d1d6;
  max-height: 200px;
  overflow-y: auto;
  z-index: 100;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

.custom-select .option {
  padding: 10px;
  text-align: center;
}

.custom-select .option:hover {
  background: #e5e5ea;
}

/* 新增按鈕 */
#addBtn {
  font-size:1.2em;
  padding:8px;
  width:100%;
  box-sizing:border-box;
  border:none;
  border-radius:12px;
  background:#007aff;
  color:#fff;
}

/* 後台欄位 */
#backend input {
  font-size:1em;
  padding:4px;
  width:60px;
  margin-right:8px;
}

/* 統計區塊 */
#totals {
  font-size:1.2em;
  padding:10px;
  background:#fff;
  border-radius:12px;
  box-shadow:0 2px 6px rgba(0,0,0,0.1);
}
</style>
</head>

<body>

<h2>甜點銷售記帳</h2>

<div class="form-card">
  日期<br>
  <input type="date" id="dateInput">
</div>

<div class="form-card">
  商品<br>
  <div class="custom-select" id="customProductSelect">
    <div class="selected">雞蛋糕</div>
    <div class="options">
      <div class="option">雞蛋糕</div>
      <div class="option">奶酪杯</div>
      <div class="option">提拉米蘇杯</div>
      <div class="option">雪媚娘</div>
      <div class="option">紅糖糍粑</div>
      <div class="option">奶茶凍</div>
      <div class="option">桂花奶酪</div>
      <div class="option">華夫餅</div>
    </div>
  </div>
</div>

<div class="form-card">
  份數<br>
  <input type="number" id="qtyInput" min="1" value="1">
</div>

<div class="form-card">
  <button id="addBtn">新增</button>
</div>

<!-- 顯示表格 -->
<table id="salesTable">
  <thead>
    <tr>
      <th>日期</th>
      <th>商品</th>
      <th>份數</th>
      <th>成本</th>
      <th>售價</th>
      <th>收入</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>

<!-- 統計區塊 -->
<div id="totals" class="form-card">
  <strong>今日總成本：</strong><span id="totalCost">0</span> 元<br>
  <strong>今日總收入：</strong><span id="totalRevenue">0</span> 元<br>
  <strong>今日總利潤：</strong><span id="totalProfit">0</span> 元
</div>

<!-- 後台設定成本售價 -->
<div id="backend" class="form-card">
  <h3>後台設定成本與售價（單位：元）</h3>
  <div>
    雞蛋糕 成本 <input type="number" id="cost_雞蛋糕" value="10">
    售價 <input type="number" id="price_雞蛋糕" value="20">
  </div>
  <div>
    奶酪杯 成本 <input type="number" id="cost_奶酪杯" value="8">
    售價 <input type="number" id="price_奶酪杯" value="15">
  </div>
  <div>
    提拉米蘇杯 成本 <input type="number" id="cost_提拉米蘇杯" value="12">
    售價 <input type="number" id="price_提拉米蘇杯" value="25">
  </div>
  <div>
    雪媚娘 成本 <input type="number" id="cost_雪媚娘" value="9">
    售價 <input type="number" id="price_雪媚娘" value="18">
  </div>
  <div>
    紅糖糍粑 成本 <input type="number" id="cost_紅糖糍粑" value="7">
    售價 <input type="number" id="price_紅糖糍粑" value="14">
  </div>
  <div>
    奶茶凍 成本 <input type="number" id="cost_奶茶凍" value="8">
    售價 <input type="number" id="price_奶茶凍" value="16">
  </div>
  <div>
    桂花奶酪 成本 <input type="number" id="cost_桂花奶酪" value="9">
    售價 <input type="number" id="price_桂花奶酪" value="17">
  </div>
  <div>
    華夫餅 成本 <input type="number" id="cost_華夫餅" value="10">
    售價 <input type="number" id="price_華夫餅" value="20">
  </div>
</div>

<script>
// 假選單 JS
const select = document.getElementById('customProductSelect');
const selected = select.querySelector('.selected');
const optionsContainer = select.querySelector('.options');
const options = optionsContainer.querySelectorAll('.option');

selected.addEventListener('click', () => {
  optionsContainer.style.display = optionsContainer.style.display === 'block' ? 'none' : 'block';
});

options.forEach(option => {
  option.addEventListener('click', () => {
    selected.textContent = option.textContent;
    optionsContainer.style.display = 'none';
  });
});

document.addEventListener('click', (e) => {
  if (!select.contains(e.target)) {
    optionsContainer.style.display = 'none';
  }
});

// 記帳功能 + 成本售價計算 + 每日統計
function updateTotals() {
  const rows = document.querySelectorAll('#salesTable tbody tr');
  let totalCost = 0, totalRevenue = 0;
  const today = document.getElementById('dateInput').value;

  rows.forEach(row => {
    const date = row.cells[0].textContent;
    if(date === today) {  // 只計算當日
      totalCost += parseFloat(row.cells[3].textContent) * parseInt(row.cells[2].textContent);
      totalRevenue += parseFloat(row.cells[5].textContent);
    }
  });

  document.getElementById('totalCost').textContent = totalCost;
  document.getElementById('totalRevenue').textContent = totalRevenue;
  document.getElementById('totalProfit').textContent = (totalRevenue - totalCost);
}

document.getElementById('addBtn').addEventListener('click', () => {
  const date = document.getElementById('dateInput').value;
  const product = selected.textContent;
  const qty = parseInt(document.getElementById('qtyInput').value);

  if(!date || !product || !qty){
    alert("請填寫完整資訊！");
    return;
  }

  const cost = parseFloat(document.getElementById('cost_' + product).value);
  const price = parseFloat(document.getElementById('price_' + product).value);
  const revenue = price * qty;

  const tbody = document.getElementById('salesTable').querySelector('tbody');
  const row = document.createElement('tr');
  row.innerHTML = `<td>${date}</td><td>${product}</td><td>${qty}</td><td>${cost}</td><td>${price}</td><td>${revenue}</td>`;
  tbody.appendChild(row);

  document.getElementById('qtyInput').value = 1;

  updateTotals(); // 更新每日統計
});

// 當日期改變也更新統計
document.getElementById('dateInput').addEventListener('change', updateTotals);
</script>

</body>
</html>
